(()=>{"use strict";let c=null,e=null;async function a(c,e){const a=await fetch(chrome.runtime.getURL(c)),t=await a.blob(),n=await createImageBitmap(t),o=new OffscreenCanvas(e,e).getContext("2d");if(!o)throw new Error("Failed to get canvas context");return o.drawImage(n,0,0,e,e),o.getImageData(0,0,e,e)}!async function(){try{c={16:await a("icons/icon-16.png",16),48:await a("icons/icon-48.png",48),128:await a("icons/icon-128.png",128)},e={16:await a("icons/icon-success-16.png",16),48:await a("icons/icon-success-48.png",48),128:await a("icons/icon-success-128.png",128)},console.log("Icons preloaded successfully")}catch(c){console.error("Failed to preload icons:",c)}}(),chrome.runtime.onMessage.addListener((a,t)=>{if("UPDATE_ICON"===a.type){const n=t.tab?.id;if(!n)return;a.success&&e?chrome.action.setIcon({tabId:n,imageData:e}).catch(c=>{console.error("Failed to set success icon:",c)}):c&&chrome.action.setIcon({tabId:n,imageData:c}).catch(c=>{console.error("Failed to set default icon:",c)})}})})();